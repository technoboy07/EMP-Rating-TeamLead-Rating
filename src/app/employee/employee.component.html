<!-- Header -->
<header class="app-header">
  <div class="logo">
  <img src="assets/Logo.png" alt="Logo">
  </div>

  
  </header>

<div class="main-container">
  <!-- Container 1: Team Lead Information -->
  <div class="container team-lead-info">
    <h2 class="container-title">
      Team Lead Information
    </h2>
    <div class="form-grid">
      <div class="form-group">
        <label class="form-label">Team Lead ID</label>
        <input 
          type="text" 
          class="form-input readonly" 
          [(ngModel)]="teamLeadId" 
          readonly
        >
      </div>
      <div class="form-group">
        <label class="form-label">Team Lead Name</label>
        <input 
          type="text" 
          class="form-input readonly" 
          [(ngModel)]="teamLeadName" 
          readonly
        >
      </div>
    </div>
  </div>

  <!-- Container 2: Date Selection -->
  <div class="container date-selection">
    <h2 class="container-title">
      Date Selection
    </h2>
    <div class="date-container">
      <div class="date-input-group">
        <label class="form-label">Select Date</label>
        <input 
          type="date" 
          class="form-input" 
          [(ngModel)]="selectedDate"
        >
      </div>
      <button 
        class="btn btn-primary save-btn" 
        (click)="onDateSave()" 
        [disabled]="!selectedDate"
      >
        Search
      </button>
    </div>

   <button class="btn btn-danger exit-btn" (click)="onExit()">
    Exit
  </button>
  </div>

  <!-- Container 3: Employee Table -->
  <div class="container employee-table" *ngIf="employees.length > 0">
    <h2 class="container-title">
      Employee Evaluation
    </h2>
    
    <div class="table-container">
      <table class="evaluation-table">
        <thead>
          <tr>
            <th>Employee ID</th>
            <th>Employee Name</th>
            <th>Tasks</th>
            <th>Rating (1-6)</th>
            <th>Remarks</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let employee of employees" class="table-row">
            <td>{{ employee.employeeId }}</td>
            <td>{{ employee.employeeName }}</td>
            <td>
              <div class="dropdown-container">
                <button 
                  class="dropdown-btn" 
                  (click)="toggleDropdown(employee.employeeId)"
                >
                  {{ getSelectedTaskName(employee.employeeId) || 'Select Task' }}
                  <span class="dropdown-arrow">▼</span>
                </button>
                <div 
                  class="dropdown-menu" 
                  *ngIf="dropdownOpen[employee.employeeId]"
                >
                  <div 
                    *ngFor="let task of employee.tasks"
                    class="dropdown-item-wrapper"
                  >
                    <button 
                      class="dropdown-item"
                      (click)="onTaskSelect(employee.employeeId, task)"
                    >
                      {{ task.name }}
                    </button>
                    <button 
                      class="info-icon-btn"
                      (click)="viewTaskDetails(employee.employeeId, task)"
                      title="View task details"
                    >
                      ℹ️
                    </button>
                  </div>
                </div>
              </div>
            </td>
           <td>
              <select 
               [(ngModel)]="ratings[employee.employeeId]" 
               (ngModelChange)="onRatingChange(employee.employeeId, $event)">
               <option value="">-- Select --</option>
               <option *ngFor="let num of [1,2,3,4,5,6]" [value]="num">{{ num }}</option>
              </select>

            </td>

            <td>
              <input 
                type="text" 
                class="remark-input" 
                placeholder="Enter remarks..."
                [value]="getRemark(employee.employeeId)"
                (input)="onRemarkChange(employee.employeeId, $event)"
              >
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="btn btn-secondary" (click)="onReset()">
        Reset
      </button>
      <button 
        class="btn btn-success" 
        (click)="onSubmit()" 
        [disabled]="!isFormValid()"
      >
        Submit
      </button>
    </div>
  </div>
</div>

<!-- Task Details Modal -->
<div class="modal-backdrop" *ngIf="showTaskModal" (click)="closeTaskModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3 class="modal-title">Task Details</h3>
      <button class="close-btn" (click)="closeTaskModal()">
        <span class="close-icon">✕</span>
      </button>
    </div>
    
    <div class="modal-body" *ngIf="selectedTask">
      <div class="detail-row">
        <span class="detail-label">Task:</span>
        <p class="detail-value">{{ selectedTask.name }}</p>
      </div>
      <div class="detail-row">
        <span class="detail-label">PR Link:</span>
        <p class="detail-value">
          <a *ngIf="selectedTask.prLink" [href]="selectedTask.prLink" target="_blank">
            {{ selectedTask.prLink }}
          </a>
          <span *ngIf="!selectedTask.prLink">No PR link provided</span>
        </p>
      </div>
      <div class="detail-row">
        <span class="detail-label">Description:</span>
        <p class="detail-value">{{ selectedTask.description || 'No description provided' }}</p>
      </div>
      <div class="detail-row">
        <span class="detail-label">Status:</span>
        <span class="status-badge" [ngClass]="getStatusClass(selectedTask.status || '')">
          {{ selectedTask.status || 'Unknown' }}
        </span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Hours:</span>
        <p class="detail-value">{{ formatTime(selectedTask.hours) }}</p>
      </div>
      <div class="detail-row">
        <span class="detail-label">Extra Hours:</span>
        <p class="detail-value">{{ formatTime(selectedTask.extraHours) }}</p>
      </div>
    </div>
  </div>
</div>

<!-- ✅ Custom Alert Modal -->
<div *ngIf="showAlert" class="custom-alert-overlay">
  <div class="custom-alert-box">
    <p>{{ alertMessage }}</p>
    <button (click)="closeCustomAlert()">OK</button>
  </div>
</div>

<!-- ✅ Custom Confirm Modal -->
<div *ngIf="showConfirm" class="custom-alert-overlay">
  <div class="custom-alert-box">
    <p>{{ confirmMessage }}</p>
    <div class="btn-group">
      <button class="btn-yes" (click)="confirmYes()">Yes</button>
      <button class="btn-no" (click)="confirmNo()">No</button>
    </div>
  </div>
</div>